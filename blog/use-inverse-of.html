<!doctype html>
<html>
  <head>
    <title>Use inverse_of - rossta.net</title>
<meta name="description" content="ActiveRecord will try hard to infer the inverse relation for your associations, but you may benefit from setting the inverse_of option wherever possible" />
<meta name="keywords" content="Ruby, Rails" />
<meta name="site" content="rossta.net" />
<meta property="og:site_name" content="rossta.net" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:creator" content="Ross Kaffenberger" />
<meta name="twitter:description" content="ActiveRecord will try hard to infer the inverse relation for your associations, but you may benefit from setting the inverse_of option wherever possible" />
<meta name="twitter:image:src" content="https://rossta.net/assets/images/blog/stock/fall-leaves-pexels-photo-3210b976.jpg" />
<meta name="twitter:title" content="Use inverse_of" />
<meta property="og:description" content="ActiveRecord will try hard to infer the inverse relation for your associations, but you may benefit from setting the inverse_of option wherever possible" />
<meta property="og:image" content="https://rossta.net/assets/images/blog/stock/fall-leaves-pexels-photo-3210b976.jpg" />
<meta property="og:title" content="Use inverse_of" />
    <meta charset="utf-8" />
    <meta http-equiv='X-UA-Compatible' content='IE=edge;chrome=1' />
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="mobile-web-app-capable" content="yes">

    <link rel="pingback" href="https://webmention.io/rossta.net/xmlrpc" />
    <link rel="webmention" href="https://webmention.io/rossta.net/webmention" />

    <script type="text/javascript" src="//use.typekit.net/ned0mml.js"></script>
    <script type="text/javascript">try{Typekit.load();}catch(e){}</script>
    <link href="/app-f0ea5135.css" rel="stylesheet" />
  </head>
  <body id="application" class="typekit">
    <nav id="welcome-nav" class="top-bar" data-topbar>
  <ul class="title-area">
    <li class="name">
      <h1><a class="logo" href="/"><img src="/assets/images/turtle-logo-096698b6.svg" alt="Turtle logo" /><span>rossta.net</span></a></h1>
    </li>
    <li class="toggle-topbar menu-icon"><a href="#">Menu</a></li>
  </ul>

  <section class="top-bar-section">
    <ul class="left">
      <li class="nav"><a href="/blog">blog</a></li>
      <li class="nav"><a href="/series">series</a></li>
      <li class="nav"><a href="/talks">talks</a></li>
      <li class="nav"><a href="/projects">projects</a></li>
      <li class="nav"><a href="/about">about</a></li>
      <li class="nav"><a href="/feed.xml">feed</a></li>
    </ul>
  </section>
</nav>

    <div class="row">
      <section id="main" role="main" class="large-12 small-12 columns">
          <section id="blog" class="margin-bottom double">
    <article class="post margin-bottom double">
      <header class="page-header with-summary">
  <h1>
    Use inverse_of
  </h1>
    <h3>
      Skip the Rails magic and set the :inverse_of option on your ActiveRecord associations
    </h3>
</header>


      <p>Let&#39;s talk about <code>:inverse_of</code>.</p>

<p>We know Rails has ActiveRecord and ActiveRecord gives us associations and associations can really simplify our interactions with databases. These associations provide a number of configuration options, one of which is to set the &quot;inverse of&quot; your current relation.</p>

<p>This option name can be a little confusing at first so let&#39;s use an example. Let&#39;s say we have an
<code>Author</code> class and it <code>has_many :posts</code>. This means we should have a <code>Post</code> class that maintains a
column, <code>:author_id</code>, so it we can say it <code>belongs_to :author</code>.</p>

<pre><code class="ruby"># app/models/author.rb
class Author &lt; ActiveRecord::Base
  has_many :posts
end

# app/models/post.rb
class Post &lt; ActiveRecord::Base
  belongs_to :author
end
</code></pre>

<p>Ok, so we know this means if we have an author, we can ask for her posts.</p>

<pre><code class="ruby"># Loading development environment (Rails 4.2.5)
author = Author.find(1)
#  Author Load (0.3ms)  SELECT  &quot;authors&quot;.* FROM &quot;authors&quot; WHERE &quot;authors&quot;.&quot;id&quot; = $1 LIMIT 1  [[&quot;id&quot;, 1]]
#=&gt; #&lt;Author:0x007fde81898868 id: 1, ... &gt;

author.posts
#  Post Load (0.4ms)  SELECT &quot;posts&quot;.* FROM &quot;posts&quot; WHERE &quot;posts&quot;.&quot;author_id&quot; = $1  [[&quot;author_id&quot;, 1]]
#=&gt; [#&lt;Post:0x007fde810cb4a0 id: 1, ... &gt;, #&lt;Post:0x007fde810cb248 id: 2, ... &gt;, ... ]
</code></pre>

<p>We can also query for a post and ask for its author.</p>

<pre><code class="ruby">post = Post.find(1)
#  Post Load (0.3ms)  SELECT  &quot;posts&quot;.* FROM &quot;posts&quot; WHERE &quot;posts&quot;.&quot;id&quot; = $1 LIMIT 1  [[&quot;id&quot;, 1]]
#=&gt; #&lt;Post:0x007fde81c7d730 id: 1, ... &gt;

post.author
#  Author Load (0.3ms)  SELECT  &quot;authors&quot;.* FROM &quot;authors&quot; WHERE &quot;authors&quot;.&quot;id&quot; = $1 LIMIT 1  [[&quot;id&quot;, 1]]
#=&gt; #&lt;Author:0x007fde7a5c8518 id: 1, ... &gt;
</code></pre>

      <h3 id="what-it-39-s-for" class="title">
        <a name="what-it-39-s-for" class="anchor" href="#what-it-39-s-for">       <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16">
       <path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"></path>
       </svg>
</a>
        What It&#39;s For
      </h3>
    
<p>Now, for most of our associations, Rails helps us find the <strong>inverse</strong> relation. For example, if we
start with an author, then ask for her posts, each post will &quot;know&quot; that the inverse instance of this
relationship is the author. If we iterate over each of <code>author.posts</code> and ask each post for its
author, we expect to get the same author record:</p>

<pre><code class="ruby">author.posts.map { |post| post.author }
# =&gt; [#&lt;Author:0x007fde81898868 id: 1, ... &gt;, #&lt;Author:0x007fde81898868 id: 1, ... &gt;, ...]
</code></pre>

<p>For consistency, we want each post&#39;s author not only to be the same record, but the same
<strong>instance</strong> in memory. If I modify one author&#39;s attributes, I expect that change to be reflected no
matter with inverse I&#39;m working with. Let&#39;s confirm by inspecting the <code>:object_id</code>:</p>

<pre><code class="ruby">author.object_id
# =&gt; 70296816370740

object_ids = [author.object_id] + author.posts.map { |post| post.author.object_id }
# =&gt; [70296816370740, 70296816370740, 70296816370740, ... ]

object_ids.uniq.size == 1
# =&gt; true
</code></pre>

<p>Great!, This means we can say that, for the <code>Author</code> class, <code>:author</code> is the &quot;inverse of&quot; the
<code>has_many :posts</code> association. So we could add the <code>:inverse_of</code> option to specify the name of the
inverse association to ensure our object instances match up.</p>

<pre><code class="ruby"># app/models/author.rb
class Author &lt; ActiveRecord::Base
  has_many :posts, inverse_of: :author
end

# app/models/post.rb
class Post &lt; ActiveRecord::Base
  belongs_to :author, inverse_of: :posts
end
</code></pre>

<p>For this example, providing this option will not change the behavior because Rails is already
setting the correct inverse instances as we might expect.</p>

<p>It may seem obvious, but Rails has to do some work to set the inverse instance on records in an association and must infer the object based on the class name and association name.</p>

<p>So it should <strong>just workâ„¢</strong>!</p>

      <h3 id="it-doesn-39-t-always-work" class="title">
        <a name="it-doesn-39-t-always-work" class="anchor" href="#it-doesn-39-t-always-work">       <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16">
       <path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"></path>
       </svg>
</a>
        It Doesn&#39;t Always Work
      </h3>
    
<p>I noticed something odd the other day.</p>

<p>I was reviewing code for our Rails app which introduced abstraction to render a list of items given by a <code>has_many</code> association. The code was passing around the inverse instance (the original owner of the association) all over the place.</p>

<p>Wouldn&#39;t we expect the inverse to be available on our <code>has_many</code> items?</p>

<p>Let&#39;s look at an oversimplified example of what we were dealing with. Building on our <code>Author</code> and <code>Post</code> from earlier, we&#39;ll add a <code>Tweet</code> class. Using ActiveRecord&#39;s single-table inheritance mechanism, <code>Tweet</code> inherits functionality from <code>Post</code>.</p>

<pre><code class="ruby"># app/models/author.rb
class Author &lt; ActiveRecord::Base
  has_many :posts
  has_many :tweets, class_name: &#39;Tweet&#39;
end

# app/models/post.rb
class Post &lt; ActiveRecord::Base
  belongs_to :author
end

# app/models/tweet.rb
class Tweet &lt; Post
  validates :text, length: { maximum: 140 }
end
</code></pre>

<p>The <code>Author</code> class <code>has_many :tweets</code> and each tweet has an author since it inherits its associations from <code>Post</code>.</p>

<pre><code class="ruby">tweet = Tweet.last
#=&gt; #&lt;Tweet:0x007fc24c1dadd8 id: 10, ... &gt;

tweet.author
#=&gt; #&lt;Author:0x007fc248e11998# id: 1, ... &gt;
</code></pre>

<p>The code was rendering each tweet in a list and each tweet needed to refer back to the author for additional data.</p>

<pre><code class="ruby">author = Author.find(1)
# Author Load (0.2ms)  SELECT  &quot;authors&quot;.* FROM &quot;authors&quot; WHERE &quot;authors&quot;.&quot;id&quot; = $1 LIMIT 1  [[&quot;id&quot;, 1]]
#=&gt; #&lt;Author:0x007fc24dee1ad0 ...&gt;

author.tweets.map { |tw| author.twitter_handle }
# Tweet Load (0.3ms)  SELECT &quot;posts&quot;.* FROM &quot;posts&quot; WHERE &quot;posts&quot;.&quot;type&quot; IN (&#39;Tweet&#39;) AND &quot;posts&quot;.&quot;author_id&quot; = $1  [[&quot;author_id&quot;, 1]]
#=&gt; [&#39;vicenta&#39;, &#39;vicenta&#39;, ... ]
</code></pre>

<p>It seemed odd to pass the author author around.</p>

<p>Each <code>tweet</code> defines its <code>author</code> association since it inherits from <code>Post</code>. I knew my colleague would have had a good reason for passing the <code>author</code> instance along so I opened up a <code>rails console</code> to find out what happened if I used the inverse association instead:</p>

<pre><code class="ruby">author = Author.find(1)
# Author Load (0.2ms)  SELECT  &quot;authors&quot;.* FROM &quot;authors&quot; WHERE &quot;authors&quot;.&quot;id&quot; = $1 LIMIT 1  [[&quot;id&quot;, 1]]
#=&gt; #&lt;Author:0x007fc24dee1ad0 ...&gt;

author.tweets.map { |tw| tw.author.twitter_handle }
# Tweet Load (0.3ms)  SELECT &quot;posts&quot;.* FROM &quot;posts&quot; WHERE &quot;posts&quot;.&quot;type&quot; IN (&#39;Tweet&#39;) AND &quot;posts&quot;.&quot;author_id&quot; = $1  [[&quot;author_id&quot;, 1]]
# Author Load (0.1ms)  SELECT  &quot;authors&quot;.* FROM &quot;authors&quot; WHERE &quot;authors&quot;.&quot;id&quot; = $1 LIMIT 1  [[&quot;id&quot;, 1]]
# Author Load (0.1ms)  SELECT  &quot;authors&quot;.* FROM &quot;authors&quot; WHERE &quot;authors&quot;.&quot;id&quot; = $1 LIMIT 1  [[&quot;id&quot;, 1]]
# Author Load (0.1ms)  SELECT  &quot;authors&quot;.* FROM &quot;authors&quot; WHERE &quot;authors&quot;.&quot;id&quot; = $1 LIMIT 1  [[&quot;id&quot;, 1]]
# Author Load (0.1ms)  SELECT  &quot;authors&quot;.* FROM &quot;authors&quot; WHERE &quot;authors&quot;.&quot;id&quot; = $1 LIMIT 1  [[&quot;id&quot;, 1]]
# Author Load (0.1ms)  SELECT  &quot;authors&quot;.* FROM &quot;authors&quot; WHERE &quot;authors&quot;.&quot;id&quot; = $1 LIMIT 1  [[&quot;id&quot;, 1]]
# Author Load (0.1ms)  SELECT  &quot;authors&quot;.* FROM &quot;authors&quot; WHERE &quot;authors&quot;.&quot;id&quot; = $1 LIMIT 1  [[&quot;id&quot;, 1]]
# Author Load (0.1ms)  SELECT  &quot;authors&quot;.* FROM &quot;authors&quot; WHERE &quot;authors&quot;.&quot;id&quot; = $1 LIMIT 1  [[&quot;id&quot;, 1]]
# ...
#=&gt; [&#39;vicenta&#39;, &#39;vicenta&#39;, ... ]
</code></pre>

<p>That&#39;s a lot of database queries for one author!</p>

<p>It&#39;s the classic problem with <code>has_many</code> associations: the &quot;N+1&quot; query. After the initial <code>author.tweet</code> query, &quot;N&quot; additional queries are needed to call each <code>tweet.author</code> back through the <code>belongs_to</code> association. We were avoiding the extra lookups by passing around the original author instance.</p>

<p>This is unfortunate because we, as we have seen, it should be possible to avoid these extra queries so that each tweet&#39;s author points to the same author object in memory.</p>

<p>Not only do we want to avoid the extra queries, but if modifications are made in one place, we&#39;d like them to be reflected elsewhere. I want to avoid something like this:</p>

<pre><code class="ruby">tweet_1 = author.tweets.first
tweet_2 = author.tweets.second

tweet_1.author.name # =&gt; &quot;Cecily&quot;
tweet_2.author.name # =&gt; &quot;Cecily&quot;

tweet_1.author.name = &quot;Martha&quot;

tweet_1.author.name # =&gt; &quot;Martha&quot;
tweet_2.author.name # =&gt; &quot;Cecily&quot;
</code></pre>

<p>So passing the <code>author</code> instance variable into the block, as an additional argument to method calls, or down to a view template is one workaround. But this can be difficult to maintain, especially if we&#39;re dealing with more than one author&#39;s posts. Wouldn&#39;t it be better not to make those unnecessary queries?</p>

<p>Well, it&#39;s possible! <code>:inverse_of</code> to the rescue.</p>

<pre><code class="ruby">class Author &lt; ActiveRecord::Base
  has_many :tweets, inverse_of: :author
end

class Tweet &lt; ActiveRecord::Base
  belongs_to :author, inverse_of: :tweets
end
</code></pre>

<p>Now when iterate over the tweets and reference the author, <strong>no additional queries
are needed</strong> because each tweet can now assign its author association from the
instance that exists already in memory:</p>

<pre><code class="ruby">author = Author.find(1)
# Author Load (0.3ms)  SELECT  &quot;authors&quot;.* FROM &quot;authors&quot; WHERE &quot;authors&quot;.&quot;id&quot; = $1 LIMIT 1  [[&quot;id&quot;, 1]]
#=&gt; #&lt;Author:0x007fc24c65c028 ... &gt;
author.tweets.map { |tw| tw.author.twitter_handle }
# Tweet Load (0.3ms)  SELECT &quot;posts&quot;.* FROM &quot;posts&quot; WHERE &quot;posts&quot;.&quot;type&quot; IN (&#39;Tweet&#39;) AND &quot;posts&quot;.&quot;author_id&quot; = $1  [[&quot;author_id&quot;, 1]]
=&gt; [&quot;vicenta&quot;, ... ]
</code></pre>

<p>Notice that additional queries for the author (<code>Author Load...</code>) don&#39;t appear in the query log: no more &quot;N+1&quot;!</p>

<p>You might be asking... why doesn&#39;t Rails just do this by default all the time? That&#39;s a good question. Turns out, it&#39;s not so easy. The <a href="http://guides.rubyonrails.org/association_basics.html#bi-directional-associations">Rails guides</a> say:</p>

<blockquote>
<p>Every association will attempt to automatically find the inverse association and set the <code>:inverse_of</code> option heuristically (based on the association name). Most associations with standard names will be supported.</p>
</blockquote>

<p>So Rails will &quot;try hard&quot; to make the inverse association work automatically to prevent the extra queries. If no name is found with the <code>:inverse_of</code> key in the association options, ActiveRecord will try to find the inverse association automatically inferring the class name from the association name, i.e. as <code>Post</code> is implied by <code>has_many :posts</code>.</p>

<p>To summarize, when the name of the association and the name of the class Rails expects to find in the
association don&#39;t match, or other certain other options are uses, automatic inverse lookup won&#39;t happen. Then you may see extra
queries for objects that already exist in memory.</p>

      <h3 id="avoid-uncertainty-be-explicit" class="title">
        <a name="avoid-uncertainty-be-explicit" class="anchor" href="#avoid-uncertainty-be-explicit">       <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16">
       <path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"></path>
       </svg>
</a>
        Avoid Uncertainty, Be Explicit
      </h3>
    
<p>Here&#39;s my recommendation:</p>

<p><strong>Set the <code>:inverse_of</code> option wherever you can.</strong></p>

<p>Yeah, Rails will try hard to do automatic inverses on your behalf, but <strong>leaving it up to Rails adds uncertainty</strong>. The uncertainty makes me uncomfortable.</p>

<p>Also know that <strong>other ActiveRecord options can interfere with automatic inverses</strong>: for example, using <code>:foreign_key</code> in your association will make it impossible to guess the inverse. In these cases, if you expect to have inverses set properly, using <code>:inverse_of</code> is necessary.</p>

<p>Here&#39;s an opportunity to reduce the chances that a name change or a Rails upgrade will introduce unexpected behavior to your application. I don&#39;t really want to write tests to be sure I&#39;m not unintentionally generating a &quot;N+1&quot; queries for my associations. I want to make it easier to introduce other changes into my app later.</p>

<p><strong>Beware of the gotchas</strong>: <code>:inverse_of</code> will only work with <code>has_many</code>, <code>has_one</code>, and <code>belong_to</code> associations and they will not work with the <code>:as</code>, <code>:polymorphic</code>, and <code>:through</code> options. <a href="http://guides.rubyonrails.org/association_basics.html#bi-directional-associations">Check out to the Rails docs on bi-directional associations</a> for more info.</p>

<p>Save yourself the trouble and set <code>:inverse_of</code> for valid <code>belongs_to</code>, <code>has_many</code>, and <code>has_one</code> associations.</p>

    </article>

    <section class="signup-form-standalone margin-bottom quadruple">
      <script src="https://f.convertkit.com/ckjs/ck.5.js"></script>
<form
  action="https://app.convertkit.com/forms/818387/subscriptions?ref=Ruby"
  class="seva-form formkit-form"
  method="post"
  data-sv-form="818387"
  data-uid="cda82aafbf"
  data-format="inline"
  data-version="5"
  data-options="{&quot;settings&quot;:{&quot;after_subscribe&quot;:{&quot;action&quot;:&quot;message&quot;,&quot;success_message&quot;:&quot;Success! Now check your email to confirm your subscription.&quot;,&quot;redirect_url&quot;:&quot;&quot;},&quot;modal&quot;:{&quot;trigger&quot;:&quot;timer&quot;,&quot;scroll_percentage&quot;:null,&quot;timer&quot;:&quot;300&quot;,&quot;devices&quot;:null,&quot;show_once_every&quot;:&quot;7&quot;},&quot;recaptcha&quot;:{&quot;enabled&quot;:false},&quot;return_visitor&quot;:{&quot;action&quot;:&quot;show&quot;,&quot;custom_content&quot;:&quot;&quot;},&quot;slide_in&quot;:{&quot;display_in&quot;:null,&quot;trigger&quot;:null,&quot;scroll_percentage&quot;:null,&quot;timer&quot;:null,&quot;devices&quot;:null,&quot;show_once_every&quot;:null}}}"
  min-width="400 500 600 700 800"
>
  <div data-style="clean">
      <h3>
  Did you like this post?
</h3>
<p>
  Please
  <a href="https://twitter.com/intent/tweet?text=Use%20inverse_of&amp;url=https%3A%2F%2Frossta.net%2Fblog%2Fuse-inverse-of.html" target="_blank" rel="noopener">share it on Twitter</a>
  and enter your email below to subscribe to my newsletter on
  Ruby, Rails, and the web. Thank you!
</p>

    <ul class="formkit-alert formkit-alert-error" data-element="errors" data-group="alert"></ul>
    <div data-element="fields" data-stacked="false" class="seva-fields formkit-fields">
      <div class="formkit-field">
        <input
          class="formkit-input"
          name="email_address"
          placeholder="Your email address"
          required=""
          type="text"
          style="border-color: rgb(227, 227, 227); border-radius: 4px; color: rgb(0, 0, 0); font-weight: 400;"
        />
      </div>
      <button
        data-element="submit"
        class="formkit-submit formkit-submit"
        style="background-color: rgb(22, 119, 190); border-radius: 4px; color: rgb(255, 255, 255); font-weight: 400;"
      >
        <div class="formkit-spinner">
          <div></div>
          <div></div>
          <div></div>
        </div>
        <span>Subscribe</span>
      </button>
    </div>
    <a
      href="https://convertkit.com/?utm_source=dynamic&amp;utm_medium=referral&amp;utm_campaign=poweredby&amp;utm_content=form"
      class="formkit-powered-by"
      data-element="powered-by"
      target="_blank"
      rel="noopener noreferrer"
      >Powered By ConvertKit</a
    >
  </div>
  <style>
    .formkit-form[data-uid='cda82aafbf'] * {
      font-family: 'Helvetica Neue', Helvetica, Arial, Verdana, sans-serif;
      box-sizing: border-box;
    }
    .formkit-form[data-uid='cda82aafbf'] legend {
      border: none;
      font-size: inherit;
      margin-bottom: 10px;
      padding: 0;
      position: relative;
      display: table;
    }
    .formkit-form[data-uid='cda82aafbf'] fieldset {
      border: 0;
      padding: 0.01em 0 0 0;
      margin: 0;
      min-width: 0;
    }
    .formkit-form[data-uid='cda82aafbf'] body:not(:-moz-handler-blocked) fieldset {
      display: table-cell;
    }

    .formkit-form[data-uid='cda82aafbf'][data-format='modal'] {
      display: none;
    }
    .formkit-form[data-uid='cda82aafbf'][data-format='slide in'] {
      display: none;
    }
    .formkit-form[data-uid='cda82aafbf'] .formkit-input,
    .formkit-form[data-uid='cda82aafbf'] .formkit-select,
    .formkit-form[data-uid='cda82aafbf'] .formkit-checkboxes {
      width: 100%;
    }
    .formkit-form[data-uid='cda82aafbf'] .formkit-button,
    .formkit-form[data-uid='cda82aafbf'] .formkit-submit {
      border: 0;
      border-radius: 5px;
      color: #ffffff;
      cursor: pointer;
      display: inline-block;
      text-align: center;
      font-size: 15px;
      font-weight: 500;
      cursor: pointer;
      margin-bottom: 15px;
      overflow: hidden;
      padding: 0;
      position: relative;
      vertical-align: middle;
    }
    .formkit-form[data-uid='cda82aafbf'] .formkit-button:hover,
    .formkit-form[data-uid='cda82aafbf'] .formkit-submit:hover,
    .formkit-form[data-uid='cda82aafbf'] .formkit-button:focus,
    .formkit-form[data-uid='cda82aafbf'] .formkit-submit:focus {
      outline: none;
    }
    .formkit-form[data-uid='cda82aafbf'] .formkit-button:hover > span,
    .formkit-form[data-uid='cda82aafbf'] .formkit-submit:hover > span,
    .formkit-form[data-uid='cda82aafbf'] .formkit-button:focus > span,
    .formkit-form[data-uid='cda82aafbf'] .formkit-submit:focus > span {
      background-color: rgba(0, 0, 0, 0.1);
    }
    .formkit-form[data-uid='cda82aafbf'] .formkit-button > span,
    .formkit-form[data-uid='cda82aafbf'] .formkit-submit > span {
      display: block;
      -webkit-transition: all 300ms ease-in-out;
      transition: all 300ms ease-in-out;
      padding: 12px 24px;
    }
    .formkit-form[data-uid='cda82aafbf'] .formkit-input {
      background: #ffffff;
      font-size: 15px;
      padding: 12px;
      border: 1px solid #e3e3e3;
      -webkit-flex: 1 0 auto;
      -ms-flex: 1 0 auto;
      flex: 1 0 auto;
      line-height: 1.4;
      margin: 0;
      -webkit-transition: border-color ease-out 300ms;
      transition: border-color ease-out 300ms;
    }
    .formkit-form[data-uid='cda82aafbf'] .formkit-input:focus {
      outline: none;
      border-color: #1677be;
      -webkit-transition: border-color ease 300ms;
      transition: border-color ease 300ms;
    }
    .formkit-form[data-uid='cda82aafbf'] .formkit-input::-webkit-input-placeholder {
      color: #848585;
    }
    .formkit-form[data-uid='cda82aafbf'] .formkit-input::-moz-placeholder {
      color: #848585;
    }
    .formkit-form[data-uid='cda82aafbf'] .formkit-input:-ms-input-placeholder {
      color: #848585;
    }
    .formkit-form[data-uid='cda82aafbf'] .formkit-input::placeholder {
      color: #848585;
    }
    .formkit-form[data-uid='cda82aafbf'] [data-group='dropdown'] {
      position: relative;
      display: inline-block;
      width: 100%;
    }
    .formkit-form[data-uid='cda82aafbf'] [data-group='dropdown']::before {
      content: '';
      top: calc(50% - 2.5px);
      right: 10px;
      position: absolute;
      pointer-events: none;
      border-color: #4f4f4f transparent transparent transparent;
      border-style: solid;
      border-width: 6px 6px 0 6px;
      height: 0;
      width: 0;
      z-index: 999;
    }
    .formkit-form[data-uid='cda82aafbf'] [data-group='dropdown'] select {
      height: auto;
      width: 100%;
      cursor: pointer;
      color: #333333;
      line-height: 1.4;
      margin-bottom: 0;
      padding: 0 6px;
      -webkit-appearance: none;
      -moz-appearance: none;
      appearance: none;
      font-size: 15px;
      padding: 12px;
      padding-right: 25px;
      border: 1px solid #e3e3e3;
      background: #ffffff;
    }
    .formkit-form[data-uid='cda82aafbf'] [data-group='dropdown'] select:focus {
      outline: none;
    }
    .formkit-form[data-uid='cda82aafbf'] [data-group='checkboxes'] {
      text-align: left;
      margin: 0;
    }
    .formkit-form[data-uid='cda82aafbf'] [data-group='checkboxes'] [data-group='checkbox'] {
      margin-bottom: 10px;
    }
    .formkit-form[data-uid='cda82aafbf'] [data-group='checkboxes'] [data-group='checkbox'] * {
      cursor: pointer;
    }
    .formkit-form[data-uid='cda82aafbf']
      [data-group='checkboxes']
      [data-group='checkbox']:last-of-type {
      margin-bottom: 0;
    }
    .formkit-form[data-uid='cda82aafbf']
      [data-group='checkboxes']
      [data-group='checkbox']
      input[type='checkbox'] {
      display: none;
    }
    .formkit-form[data-uid='cda82aafbf']
      [data-group='checkboxes']
      [data-group='checkbox']
      input[type='checkbox']
      + label::after {
      content: none;
    }
    .formkit-form[data-uid='cda82aafbf']
      [data-group='checkboxes']
      [data-group='checkbox']
      input[type='checkbox']:checked
      + label::after {
      border-color: #ffffff;
      content: '';
    }
    .formkit-form[data-uid='cda82aafbf']
      [data-group='checkboxes']
      [data-group='checkbox']
      input[type='checkbox']:checked
      + label::before {
      background: #10bf7a;
      border-color: #10bf7a;
    }
    .formkit-form[data-uid='cda82aafbf'] [data-group='checkboxes'] [data-group='checkbox'] label {
      position: relative;
      display: inline-block;
      padding-left: 28px;
    }
    .formkit-form[data-uid='cda82aafbf']
      [data-group='checkboxes']
      [data-group='checkbox']
      label::before,
    .formkit-form[data-uid='cda82aafbf']
      [data-group='checkboxes']
      [data-group='checkbox']
      label::after {
      position: absolute;
      content: '';
      display: inline-block;
    }
    .formkit-form[data-uid='cda82aafbf']
      [data-group='checkboxes']
      [data-group='checkbox']
      label::before {
      height: 16px;
      width: 16px;
      border: 1px solid #e3e3e3;
      background: #ffffff;
      left: 0px;
      top: 3px;
    }
    .formkit-form[data-uid='cda82aafbf']
      [data-group='checkboxes']
      [data-group='checkbox']
      label::after {
      height: 4px;
      width: 8px;
      border-left: 2px solid #4d4d4d;
      border-bottom: 2px solid #4d4d4d;
      -webkit-transform: rotate(-45deg);
      -ms-transform: rotate(-45deg);
      transform: rotate(-45deg);
      left: 4px;
      top: 8px;
    }
    .formkit-form[data-uid='cda82aafbf'] .formkit-alert {
      background: #f9fafb;
      border: 1px solid #e3e3e3;
      border-radius: 5px;
      -webkit-flex: 1 0 auto;
      -ms-flex: 1 0 auto;
      flex: 1 0 auto;
      list-style: none;
      margin: 25px auto;
      padding: 12px;
      text-align: center;
      width: 100%;
    }
    .formkit-form[data-uid='cda82aafbf'] .formkit-alert:empty {
      display: none;
    }
    .formkit-form[data-uid='cda82aafbf'] .formkit-alert-success {
      background: #d3fbeb;
      border-color: #10bf7a;
      color: #0c905c;
    }
    .formkit-form[data-uid='cda82aafbf'] .formkit-alert-error {
      background: #fde8e2;
      border-color: #f2643b;
      color: #ea4110;
    }
    .formkit-form[data-uid='cda82aafbf'] .formkit-spinner {
      display: -webkit-box;
      display: -webkit-flex;
      display: -ms-flexbox;
      display: flex;
      height: 0px;
      width: 0px;
      margin: 0 auto;
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      width: 0px;
      overflow: hidden;
      text-align: center;
      -webkit-transition: all 300ms ease-in-out;
      transition: all 300ms ease-in-out;
    }
    .formkit-form[data-uid='cda82aafbf'] .formkit-spinner > div {
      margin: auto;
      width: 12px;
      height: 12px;
      background-color: #fff;
      opacity: 0.3;
      border-radius: 100%;
      display: inline-block;
      -webkit-animation: formkit-bouncedelay-formkit-form-data-uid-cda82aafbf- 1.4s infinite
        ease-in-out both;
      animation: formkit-bouncedelay-formkit-form-data-uid-cda82aafbf- 1.4s infinite ease-in-out
        both;
    }
    .formkit-form[data-uid='cda82aafbf'] .formkit-spinner > div:nth-child(1) {
      -webkit-animation-delay: -0.32s;
      animation-delay: -0.32s;
    }
    .formkit-form[data-uid='cda82aafbf'] .formkit-spinner > div:nth-child(2) {
      -webkit-animation-delay: -0.16s;
      animation-delay: -0.16s;
    }
    .formkit-form[data-uid='cda82aafbf'] .formkit-submit[data-active] .formkit-spinner {
      opacity: 1;
      height: 100%;
      width: 50px;
    }
    .formkit-form[data-uid='cda82aafbf'] .formkit-submit[data-active] .formkit-spinner ~ span {
      opacity: 0;
    }
    @-webkit-keyframes formkit-bouncedelay-formkit-form-data-uid-cda82aafbf- {
      0%,
      80%,
      100% {
        -webkit-transform: scale(0);
        -ms-transform: scale(0);
        transform: scale(0);
      }
      40% {
        -webkit-transform: scale(1);
        -ms-transform: scale(1);
        transform: scale(1);
      }
    }
    @keyframes formkit-bouncedelay-formkit-form-data-uid-cda82aafbf- {
      0%,
      80%,
      100% {
        -webkit-transform: scale(0);
        -ms-transform: scale(0);
        transform: scale(0);
      }
      40% {
        -webkit-transform: scale(1);
        -ms-transform: scale(1);
        transform: scale(1);
      }
    }
    .formkit-form[data-uid='cda82aafbf'] {
      max-width: 700px;
    }
    .formkit-form[data-uid='cda82aafbf'] [data-style='clean'] {
      width: 100%;
    }
    .formkit-form[data-uid='cda82aafbf'] .formkit-fields {
      display: -webkit-box;
      display: -webkit-flex;
      display: -ms-flexbox;
      display: flex;
      -webkit-flex-wrap: wrap;
      -ms-flex-wrap: wrap;
      flex-wrap: wrap;
      margin: 0 auto;
    }
    .formkit-form[data-uid='cda82aafbf'] .formkit-field,
    .formkit-form[data-uid='cda82aafbf'] .formkit-submit {
      margin: 0 0 15px 0;
      -webkit-flex: 1 0 100%;
      -ms-flex: 1 0 100%;
      flex: 1 0 100%;
    }
    .formkit-form[data-uid='cda82aafbf'] .formkit-powered-by {
      color: #7d7d7d;
      display: block;
      font-size: 12px;
      margin: 0;
      text-align: center;
    }
    .formkit-form[data-uid='cda82aafbf'] .formkit-powered-by[data-active='false'] {
      opacity: 0.5;
    }
    .formkit-form[data-uid='cda82aafbf'][min-width~='700'] [data-style='clean'],
    .formkit-form[data-uid='cda82aafbf'][min-width~='800'] [data-style='clean'] {
      padding: 10px;
    }
    .formkit-form[data-uid='cda82aafbf'][min-width~='700'] .formkit-fields[data-stacked='false'],
    .formkit-form[data-uid='cda82aafbf'][min-width~='800'] .formkit-fields[data-stacked='false'] {
      margin-left: -5px;
      margin-right: -5px;
    }
    .formkit-form[data-uid='cda82aafbf'][min-width~='700']
      .formkit-fields[data-stacked='false']
      .formkit-field,
    .formkit-form[data-uid='cda82aafbf'][min-width~='800']
      .formkit-fields[data-stacked='false']
      .formkit-field,
    .formkit-form[data-uid='cda82aafbf'][min-width~='700']
      .formkit-fields[data-stacked='false']
      .formkit-submit,
    .formkit-form[data-uid='cda82aafbf'][min-width~='800']
      .formkit-fields[data-stacked='false']
      .formkit-submit {
      margin: 0 5px 15px 5px;
    }
    .formkit-form[data-uid='cda82aafbf'][min-width~='700']
      .formkit-fields[data-stacked='false']
      .formkit-field,
    .formkit-form[data-uid='cda82aafbf'][min-width~='800']
      .formkit-fields[data-stacked='false']
      .formkit-field {
      -webkit-flex: 100 1 auto;
      -ms-flex: 100 1 auto;
      flex: 100 1 auto;
    }
    .formkit-form[data-uid='cda82aafbf'][min-width~='700']
      .formkit-fields[data-stacked='false']
      .formkit-submit,
    .formkit-form[data-uid='cda82aafbf'][min-width~='800']
      .formkit-fields[data-stacked='false']
      .formkit-submit {
      -webkit-flex: 1 1 auto;
      -ms-flex: 1 1 auto;
      flex: 1 1 auto;
    }
  </style>
    <input type="hidden" name="tags[]" value="733960" />
    <input type="hidden" name="tags[]" value="733966" />
  <input type="hidden" aria-label="URL" name="fields[url]" placeholder="URL" value="https://rossta.net/blog/2015-12-02-use-inverse_of.html" />
</form>


    </section>
    <article>
        <figure>
          <img src="/assets/images/blog/stock/fall-leaves-pexels-photo-3210b976.jpg" alt="Fall leaves pexels photo" />
        </figure>
    </article>
    <section class="margin-bottom double">
      <p>
        Published on Dec  2, 2015
      </p>
    </section>
  </section>
    <hr />
    <section class="comments">
      <div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname  = "rosskaff";
    var disqus_identifier = "use-inverse-of";
    var disqus_title      = "Use inverse_of";
    var disqus_url        = "https://rossta.net/blog/use-inverse-of.html";

    var disqus_config = function () {
        this.page.url = disqus_url;  // Replace PAGE_URL with your page's canonical URL variable
        this.page.identifier = disqus_identifier; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
        this.page.title = disqus_title;
    };

    (function() { // DON'T EDIT BELOW THIS LINE
        var d = document, s = d.createElement('script');
        s.src = '//rosskaff.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>

<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>

<!-- <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a> -->

    </section>

      </section>
    </div>
    
    <footer>
  <div class="row">
    <img src="/assets/images/turtle-logo-096698b6.svg" class="turtle" alt="Turtle logo" />
    <section class="large-6 columns">
      <h5>Most Popular</h5>
      <ul>
          <li><a href="/blog/building-a-pdf-viewer-with-vue-part-1.html">Rendering PDF pages with PDF.js and Vue</a></li>
          <li><a href="/blog/local-ssl-for-rails-5.html">Local SSL for Rails 5 development and tests</a></li>
          <li><a href="/blog/from-sprockets-to-webpack.html">How we switched from Sprockets to Webpack</a></li>
          <li><a href="/blog/web-push-notifications-from-rails.html">Sending Web Push Notifications from Rails</a></li>
          <li><a href="/blog/how-to-specify-local-ruby-gems-in-your-gemfile.html">How to specify local Ruby gems in your Gemfile</a></li>
      </ul>
    </section>
    <section class="large-3 columns">
      <h5>Categories</h5>
      <ul>
          <li><a href="/blog/tags/ruby.html">Ruby</a></li>
          <li><a href="/blog/tags/rails.html">Rails</a></li>
          <li><a href="/blog/tags/javascript.html">JavaScript</a></li>
          <li><a href="/blog/tags/vue.html">Vue</a></li>
          <li><a href="/blog/tags/service-worker.html">Service Worker</a></li>
      </ul>
    </section>
    <section class="large-3 columns">
      <h5>Contact</h5>
      <ul>
        <li><a href="mailto:ross@rossta.net" rel="me noopener">email</a></li>
        <li><a href="https://twitter.com/rossta" rel="me noopener">twitter</a></li>
        <li><a href="https://medium.com/@rossta" rel="me noopener">medium</a></li>
        <li><a href="https://github.com/rossta" rel="me noopener">github</a></li>
        <!-- <li><a href="https://stackoverflow.com/users/771838/rossta?tab=profile" rel="me">stackoverflow</a></li> -->
        <li><a href="https://www.linkedin.com/in/rosskaffenberger" rel="me noopener">linkedin</a></li>
      </ul>
    </section>
  </div>
  <p class="copyright small subtle center">
    Â© 2019 Ross Kaffenberger. All rights reserved.
  </p>
</footer>

    <script src="/app-8d904d48.js"></script>
    
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-16458563-2"></script>
<script type="text/javascript">
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-16458563-2');
</script>

  </body>
</html>
